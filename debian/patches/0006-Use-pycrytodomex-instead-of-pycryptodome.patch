From: Alexis Murzeau <amubtdx@gmail.com>
Date: Fri, 23 Aug 2019 18:54:27 +0200
Subject: Use pycrytodomex instead of pycryptodome

Streamlink use features specific to pycryptodome which are not available
in python3-crypto package. Only pycryptodomex python module is available
in Debian, so replace the use of pycrytodome with pycrytodomex.

Related bug python3-pycryptodome: #886291: python3-pycryptodome contains
pycryptodomex instead of pycryptodome.

Forwarded: not-needed
Author: Alexis Murzeau <amubtdx@gmail.com>
---
 setup.cfg                            | 2 +-
 src/streamlink.egg-info/requires.txt | 2 +-
 src/streamlink/plugins/abematv.py    | 2 +-
 src/streamlink/plugins/mjunoon.py    | 4 ++--
 src/streamlink/plugins/rtve.py       | 2 +-
 src/streamlink/plugins/steam.py      | 4 ++--
 src/streamlink/plugins/ustvnow.py    | 6 +++---
 src/streamlink/plugins/webtv.py      | 2 +-
 src/streamlink/stream/hls.py         | 4 ++--
 src/streamlink/utils/crypto.py       | 2 +-
 tests/stream/test_hls.py             | 4 ++--
 11 files changed, 17 insertions(+), 17 deletions(-)

diff --git a/setup.cfg b/setup.cfg
index 51df2ba..da89da4 100644
--- a/setup.cfg
+++ b/setup.cfg
@@ -41,7 +41,7 @@ install_requires =
 	isodate
 	lxml >=4.6.4,<5.0
 	pycountry
-	pycryptodome >=3.4.3,<4
+	pycryptodomex >=3.4.3,<4
 	PySocks !=1.5.7,>=1.5.6
 	requests >=2.26.0,<3.0
 	websocket-client >=1.2.1,<2.0
diff --git a/src/streamlink.egg-info/requires.txt b/src/streamlink.egg-info/requires.txt
index 898d658..48b8742 100644
--- a/src/streamlink.egg-info/requires.txt
+++ b/src/streamlink.egg-info/requires.txt
@@ -1,7 +1,7 @@
 isodate
 lxml<5.0,>=4.6.4
 pycountry
-pycryptodome<4,>=3.4.3
+pycryptodomex<4,>=3.4.3
 PySocks!=1.5.7,>=1.5.6
 requests<3.0,>=2.26.0
 websocket-client<2.0,>=1.2.1
diff --git a/src/streamlink/plugins/abematv.py b/src/streamlink/plugins/abematv.py
index ad8b153..428e24a 100644
--- a/src/streamlink/plugins/abematv.py
+++ b/src/streamlink/plugins/abematv.py
@@ -15,7 +15,7 @@ import uuid
 from base64 import urlsafe_b64encode
 from binascii import unhexlify
 
-from Crypto.Cipher import AES
+from Cryptodome.Cipher import AES
 from requests import Response
 from requests.adapters import BaseAdapter
 
diff --git a/src/streamlink/plugins/mjunoon.py b/src/streamlink/plugins/mjunoon.py
index 5fceafa..318bfa1 100644
--- a/src/streamlink/plugins/mjunoon.py
+++ b/src/streamlink/plugins/mjunoon.py
@@ -10,8 +10,8 @@ import logging
 import re
 from urllib.parse import urljoin
 
-from Crypto.Cipher import AES
-from Crypto.Util.Padding import unpad
+from Cryptodome.Cipher import AES
+from Cryptodome.Util.Padding import unpad
 
 from streamlink.plugin import Plugin, pluginmatcher
 from streamlink.plugin.api import validate
diff --git a/src/streamlink/plugins/rtve.py b/src/streamlink/plugins/rtve.py
index 145594b..5b0d70c 100644
--- a/src/streamlink/plugins/rtve.py
+++ b/src/streamlink/plugins/rtve.py
@@ -10,7 +10,7 @@ import logging
 import re
 from urllib.parse import urlparse
 
-from Crypto.Cipher import Blowfish
+from Cryptodome.Cipher import Blowfish
 
 from streamlink.plugin import Plugin, PluginArgument, PluginArguments, pluginmatcher
 from streamlink.plugin.api import validate
diff --git a/src/streamlink/plugins/steam.py b/src/streamlink/plugins/steam.py
index 2133fe5..71f842d 100644
--- a/src/streamlink/plugins/steam.py
+++ b/src/streamlink/plugins/steam.py
@@ -11,8 +11,8 @@ import logging
 import re
 import time
 
-from Crypto.Cipher import PKCS1_v1_5
-from Crypto.PublicKey import RSA
+from Cryptodome.Cipher import PKCS1_v1_5
+from Cryptodome.PublicKey import RSA
 
 from streamlink.exceptions import FatalPluginError
 from streamlink.plugin import Plugin, PluginArgument, PluginArguments, pluginmatcher
diff --git a/src/streamlink/plugins/ustvnow.py b/src/streamlink/plugins/ustvnow.py
index 6d34aa7..f95c8df 100644
--- a/src/streamlink/plugins/ustvnow.py
+++ b/src/streamlink/plugins/ustvnow.py
@@ -12,9 +12,9 @@ import re
 from urllib.parse import urljoin, urlparse
 from uuid import uuid4
 
-from Crypto.Cipher import AES
-from Crypto.Hash import SHA256
-from Crypto.Util.Padding import pad, unpad
+from Cryptodome.Cipher import AES
+from Cryptodome.Hash import SHA256
+from Cryptodome.Util.Padding import pad, unpad
 
 from streamlink.plugin import Plugin, PluginArgument, PluginArguments, PluginError, pluginmatcher
 from streamlink.stream.hls import HLSStream
diff --git a/src/streamlink/plugins/webtv.py b/src/streamlink/plugins/webtv.py
index c8cf2b2..712e447 100644
--- a/src/streamlink/plugins/webtv.py
+++ b/src/streamlink/plugins/webtv.py
@@ -9,7 +9,7 @@ import binascii
 import logging
 import re
 
-from Crypto.Cipher import AES
+from Cryptodome.Cipher import AES
 
 from streamlink.plugin import Plugin, pluginmatcher
 from streamlink.plugin.api import validate
diff --git a/src/streamlink/stream/hls.py b/src/streamlink/stream/hls.py
index bf7a1e7..d271b55 100644
--- a/src/streamlink/stream/hls.py
+++ b/src/streamlink/stream/hls.py
@@ -7,9 +7,9 @@ from typing import Any, Dict, List, NamedTuple, Optional, Tuple, Union
 from urllib.parse import urlparse
 
 # noinspection PyPackageRequirements
-from Crypto.Cipher import AES
+from Cryptodome.Cipher import AES
 # noinspection PyPackageRequirements
-from Crypto.Util.Padding import unpad
+from Cryptodome.Util.Padding import unpad
 from requests import Response
 from requests.exceptions import ChunkedEncodingError, ConnectionError, ContentDecodingError
 
diff --git a/src/streamlink/utils/crypto.py b/src/streamlink/utils/crypto.py
index abc3901..a71203f 100644
--- a/src/streamlink/utils/crypto.py
+++ b/src/streamlink/utils/crypto.py
@@ -1,6 +1,6 @@
 import hashlib
 
-from Crypto.Cipher import AES
+from Cryptodome.Cipher import AES
 
 
 def evp_bytestokey(password, salt, key_len, iv_len):
diff --git a/tests/stream/test_hls.py b/tests/stream/test_hls.py
index 0ceb82a..c0f835d 100644
--- a/tests/stream/test_hls.py
+++ b/tests/stream/test_hls.py
@@ -6,8 +6,8 @@ from unittest.mock import Mock, call, patch
 
 import pytest
 import requests_mock
-from Crypto.Cipher import AES
-from Crypto.Util.Padding import pad
+from Cryptodome.Cipher import AES
+from Cryptodome.Util.Padding import pad
 
 from streamlink.session import Streamlink
 from streamlink.stream.hls import HLSStream, HLSStreamReader
